import './polyfills.server.mjs';
import{a as H,b as K}from"./chunk-VAAL7YCS.mjs";import{Aa as l,Ba as R,Ca as D,Da as w,Ea as C,Fa as x,Ga as o,Ha as f,Ia as M,Ja as y,Ka as b,La as q,Ma as Q,Q as v,Y as F,Z as P,ha as O,kb as j,lb as L,mb as V,oa as s,pa as T,pb as A,wa as N,xa as u,ya as i,za as r}from"./chunk-37HRPQKV.mjs";import{a as k,b as I}from"./chunk-5XUXGTUW.mjs";var U=["qrCodeContainer"],S=class n{data;width=120;height=120;qrCodeContainer;ngAfterViewInit(){typeof window<"u"&&import("./chunk-U42RM2DJ.mjs").then(t=>{let e=t.default;new e({width:this.width,height:this.height,data:this.data,dotsOptions:{color:"#000",type:"square"},backgroundOptions:{color:"#ffffff"}}).append(this.qrCodeContainer.nativeElement)})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=v({type:n,selectors:[["app-qr-code"]],viewQuery:function(e,a){if(e&1&&w(U,7),e&2){let p;C(p=x())&&(a.qrCodeContainer=p.first)}},inputs:{data:"data",width:"width",height:"height"},standalone:!0,features:[y],decls:2,vars:0,consts:[["qrCodeContainer",""]],template:function(e,a){e&1&&l(0,"div",null,0)}})};var c={_origin:"https://api.emailjs.com"};var B=(n,t="https://api.emailjs.com")=>{c._userID=n,c._origin=t};var _=(n,t,e)=>{if(!n)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!e)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};var h=class{constructor(t){this.status=t.status,this.text=t.responseText}};var E=(n,t,e={})=>new Promise((a,p)=>{let d=new XMLHttpRequest;d.addEventListener("load",({target:m})=>{let g=new h(m);g.status===200||g.text==="OK"?a(g):p(g)}),d.addEventListener("error",({target:m})=>{p(new h(m))}),d.open("POST",c._origin+n,!0),Object.keys(e).forEach(m=>{d.setRequestHeader(m,e[m])}),d.send(t)});var $=(n,t,e,a)=>{let p=a||c._userID;return _(p,n,t),E("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:p,service_id:n,template_id:t,template_params:e}),{"Content-type":"application/json"})};var W=n=>{let t;if(typeof n=="string"?t=document.querySelector(n):t=n,!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return t},G=(n,t,e,a)=>{let p=a||c._userID,d=W(e);_(p,n,t);let m=new FormData(d);return m.append("lib_version","3.2.0"),m.append("service_id",n),m.append("template_id",t),m.append("user_id",p),E("/api/v1.0/email/send-form",m)};var Z={init:B,send:$,sendForm:G};var Y=["barChartCanvas"];function ee(n,t){if(n&1&&(i(0,"tr")(1,"td"),o(2),r(),i(3,"td"),o(4),r(),i(5,"td"),o(6),b(7,"number"),r(),i(8,"td"),o(9),b(10,"number"),r(),i(11,"td"),o(12),b(13,"number"),r()()),n&2){let e=t.$implicit,a=t.index;s(2),f(a+1),s(2),f(e.nama),s(2),f(q(7,5,e.target)),s(3),f(q(10,7,e.output)),s(3),M("",Q(13,9,e.pencapaian,"1.2-2"),"%")}}var J=class n{constructor(t){this.platformId=t;this.karyawanList=this.karyawanList.map(e=>I(k({},e),{pencapaian:e.output/e.target*100})).sort((e,a)=>a.pencapaian-e.pencapaian)}barChartCanvas;karyawanList=[{nama:"Abdul",target:1e6,output:96e4,pencapaian:0},{nama:"Budi",target:1e6,output:42e4,pencapaian:0},{nama:"Beni",target:1e6,output:11e5,pencapaian:0},{nama:"Rian",target:1e6,output:95e4,pencapaian:0},{nama:"Romi",target:1e6,output:1000500,pencapaian:0},{nama:"Farhan",target:1e6,output:55e4,pencapaian:0},{nama:"Krisna",target:1e6,output:953e3,pencapaian:0},{nama:"Fajar",target:1e6,output:1053e3,pencapaian:0},{nama:"Heri",target:1e6,output:876300,pencapaian:0},{nama:"Nopri",target:1e6,output:3e5,pencapaian:0},{nama:"Dermawan",target:1e6,output:989e3,pencapaian:0}].map(t=>I(k({},t),{pencapaian:t.output/t.target*100})).sort((t,e)=>e.pencapaian-t.pencapaian);ngAfterViewInit(){if(A(this.platformId)){let t=this.karyawanList.map(a=>a.nama),e=this.karyawanList.map(a=>parseFloat(a.pencapaian.toFixed(2)));new H(this.barChartCanvas.nativeElement,{type:"bar",data:{labels:t,datasets:[{label:"Pencapaian (%)",data:e,backgroundColor:"#42A5F5"}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:120}},plugins:{legend:{position:"top"}}}})}}kirimNotifikasi(){let t={Budi:"budioperator99@gmail.com",Nopri:"nopri@gmail.com"},e=this.karyawanList.filter(a=>a.pencapaian<=50);if(e.length===0){alert("Tidak ada operator dengan pencapaian \u2264 50%");return}e.forEach(a=>{let p=t[a.nama];if(p){let d={to_name:a.nama,to_email:p,message:`Halo ${a.nama}, pencapaian Anda saat ini adalah ${a.pencapaian.toFixed(2)}%. Mohon segera ditingkatkan.`};Z.send("service_i0lsc5n","template_q218pnu",d,"chOKt6wPlsM9AZOKv").then(()=>console.log(`Email berhasil dikirim ke ${a.nama}`),m=>console.error(`Gagal kirim email ke ${a.nama}`,m))}}),alert("Notifikasi telah dikirim ke operator pencapaian \u2264 50%")}static \u0275fac=function(e){return new(e||n)(T(O))};static \u0275cmp=v({type:n,selectors:[["app-home"]],viewQuery:function(e,a){if(e&1&&w(Y,5),e&2){let p;C(p=x())&&(a.barChartCanvas=p.first)}},standalone:!0,features:[y],decls:51,vars:6,consts:[["barChartCanvas",""],[1,"container","my-5","d-flex","justify-content-center"],[1,"w-100",2,"max-width","900px"],[1,"text-center","mb-4"],[1,"table","table-bordered","table-striped","text-center"],[1,"table-primary"],[4,"ngFor","ngForOf"],[1,"text-center","mt-5"],[1,"w-100"],[2,"width","100%","height","400px"],[1,"text-center","mt-4"],[1,"btn","btn-danger",3,"click"],[1,"d-flex","flex-wrap","justify-content-center","gap-4","mt-3"],[3,"data"]],template:function(e,a){if(e&1){let p=R();i(0,"div",1)(1,"div",2)(2,"h2",3),o(3,"Pencapaian Karyawan"),r(),i(4,"table",4)(5,"thead",5)(6,"tr")(7,"th"),o(8,"No"),r(),i(9,"th"),o(10,"Nama Karyawan"),r(),i(11,"th"),o(12,"Target"),r(),i(13,"th"),o(14,"Output"),r(),i(15,"th"),o(16,"Pencapaian (%)"),r()()(),i(17,"tbody"),N(18,ee,14,12,"tr",6),r()(),i(19,"h3",7),o(20,"Grafik Pencapaian Karyawan"),r(),i(21,"div",8),l(22,"canvas",9,0),r(),i(24,"div",10)(25,"button",11),D("click",function(){return F(p),P(a.kirimNotifikasi())}),o(26," Notifikasi Operator (\u2264 50%) "),r()(),i(27,"div",7)(28,"h4"),o(29,"Scan QR untuk lihat detail produk"),r(),i(30,"div",12)(31,"div"),l(32,"app-qr-code",13),i(33,"div"),o(34,"Indomie Kari"),r()(),i(35,"div"),l(36,"app-qr-code",13),i(37,"div"),o(38,"Indomie Soto"),r()(),i(39,"div"),l(40,"app-qr-code",13),i(41,"div"),o(42,"Indomie Goreng"),r()(),i(43,"div"),l(44,"app-qr-code",13),i(45,"div"),o(46,"Sarimi"),r()(),i(47,"div"),l(48,"app-qr-code",13),i(49,"div"),o(50,"Supermi"),r()()()()()()}e&2&&(s(18),u("ngForOf",a.karyawanList),s(14),u("data","/produk/1"),s(4),u("data","/produk/2"),s(4),u("data","/produk/3"),s(4),u("data","/produk/4"),s(4),u("data","/produk/5"))},dependencies:[V,j,L,K,S]})};export{J as HomeComponent};
